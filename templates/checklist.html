<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Checklist RMC</title>
    <style>
        /* CONFIGURACIÓN DE PÁGINA */
        @page { size: A4; margin: 1cm; margin-bottom: 2cm; margin-top: 1cm; }
        body { font-family: 'Helvetica', 'Arial', sans-serif; font-size: 10pt; color: #333; line-height: 1.3; }
        
        /* --- CABECERA (LOGO Y CÓDIGO) --- */
        .top-header-table { width: 100%; border: none; margin-bottom: 15px; }
        .top-header-table td { border: none; vertical-align: top; }
        .meta-info { font-size: 8pt; color: #555; text-align: left; }
        .logo-container { text-align: right; }
        .logo-img { width: 140px; } /* Ajusta tamaño de logo */
        
        /* TÍTULO PRINCIPAL */
        .main-title { 
            text-align: center; color: #004B8D; font-size: 18pt; 
            font-weight: bold; text-transform: uppercase; margin: 10px 0 20px 0; 
        }

        /* --- SECCIÓN DE DATOS (NUEVO ESTILO "FICHA TÉCNICA") --- */
        /* Este es el cambio clave: Usamos bordes reales y fondo gris */
        .info-table { 
            width: 100%; 
            border-collapse: collapse; 
            border: 1px solid #999; /* Borde exterior */
            margin-bottom: 20px;
        }
        
        .info-table td {
            padding: 6px 8px;
            border: 1px solid #ccc; /* Bordes internos sutiles */
            vertical-align: middle;
        }

        /* Celdas de TÍTULO (Etiquetas) */
        .label-cell { 
            background-color: #f2f2f2; /* Fondo Gris Claro */
            font-weight: bold; 
            color: #000; 
            font-size: 9pt; 
            width: 25%; /* Ancho fijo para que no baile */
        }

        /* Celdas de DATO (Inputs) */
        .input-cell { 
            background-color: #fff; 
            color: #000; 
            font-size: 10pt;
            font-weight: normal;
        }

        /* Firma en el encabezado */
        .header-sig-img {
            height: 45px; 
            display: block; 
            margin: 0 auto;
        }

        /* --- TABLA DE CHECKLIST (IGUAL QUE ANTES) --- */
        .instructions { text-align: right; font-size: 7pt; color: #666; margin-bottom: 5px; }
        
        table.checklist { width: 100%; border-collapse: collapse; margin-top: 0; }
        
        .header-blue { 
            background-color: #004B8D; color: white; text-align: center; 
            font-weight: bold; padding: 8px; text-transform: uppercase; font-size: 10pt;
        }
        
        .header-black th { 
            background-color: #000; color: white; font-weight: bold; 
            font-size: 8pt; padding: 6px; text-align: center; border: 1px solid #000;
        }

        .checklist td { border: 1px solid #ddd; padding: 8px 5px; vertical-align: middle; }
        .col-idx { width: 5%; text-align: center; color: #888; font-size: 9pt; }
        .col-item { width: 50%; }
        .col-ar { width: 10%; text-align: center; font-weight: bold; font-size: 11pt;}
        .col-obs { width: 35%; font-size: 9pt; }

        .status-A { color: #009933; } 
        .status-R { color: #cc0000; } 
        .status-NA { color: #666666; } 

        /* --- OBSERVACIONES --- */
        .obs-section { margin-top: 20px; }
        .obs-title { 
            background-color: #f2f2f2; border: 1px solid #ccc; border-bottom: none;
            font-weight: bold; font-size: 9pt; padding: 5px 10px; display: inline-block;
        }
        .obs-box { 
            width: 100%; padding: 10px; border: 1px solid #ccc; 
            font-size: 10pt; min-height: 40px; background-color: #fff;
            box-sizing: border-box; /* Asegura que el padding no rompa el ancho */
        }

        /* --- FOOTER --- */
        .footer {
            position: fixed; bottom: -30px; left: 0; right: 0;
            text-align: center; font-size: 8pt; color: #777;
        }
        .footer-link { color: #004B8D; font-weight: bold; text-decoration: none; }

    </style>
</head>
<body>

    <table class="top-header-table">
        <tr>
            <td>
                <div class="meta-info">
                    <strong>CÓDIGO:</strong> {{ codigo }}<br>
                    <strong>REV:</strong> {{ revision }} | <strong>FECHA:</strong> {{ fecha_rev }}
                </div>
            </td>
            <td>
                <div class="logo-container">
                    <img src="{{ logo_b64 }}" class="logo-img">
                </div>
            </td>
        </tr>
    </table>

    <div class="main-title">
        CHECKLIST INSPECCIÓN<br>HERRAMIENTAS MANUALES
    </div>

    <table class="info-table">
        <tr>
            <td class="label-cell">PROYECTO / UBICACIÓN:</td>
            <td class="input-cell" colspan="3">{{ proyecto }}</td>
        </tr>
        <tr>
            <td class="label-cell">INSPECCIÓN REALIZADA POR:</td>
            <td class="input-cell">{{ inspector }}</td>
            
            <td class="label-cell" style="width: 15%;">FECHA:</td>
            <td class="input-cell" style="width: 20%; text-align: center;">{{ fecha_chequeo }}</td>
        </tr>
        <tr>
            <td class="label-cell">FIRMA INSPECTOR:</td>
            <td class="input-cell" colspan="3" style="height: 50px; text-align: left;">
                {% if firma_b64 %}
                    <img src="{{ firma_b64 }}" class="header-sig-img" style="margin: 0; margin-left: 20px;">
                {% else %}
                    <span style="color: #ccc; font-size: 8pt;">(Sin Firma)</span>
                {% endif %}
            </td>
        </tr>
    </table>

    <div class="instructions">
        ESTADOS: <strong>A</strong> = APROBADO | <strong>R</strong> = RECHAZADO | <strong>NA</strong> = NO APLICA
    </div>

    <table class="checklist">
        <thead>
            <tr>
                <td colspan="4" class="header-blue">CONDICIONES A VERIFICAR</td>
            </tr>
            <tr class="header-black">
                <th>#</th>
                <th>ITEM</th>
                <th>ESTADO</th>
                <th>OBSERVACIONES</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td class="col-idx">{{ loop.index }}</td>
                <td class="col-item">{{ item.nombre }}</td>
                <td class="col-ar status-{{ item.estado }}">{{ item.estado }}</td>
                <td class="col-obs">{{ item.obs }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="obs-section">
        <div class="obs-title">OBSERVACIONES GENERALES</div>
        <div class="obs-box">
            {{ observaciones_generales }}
        </div>
    </div>

    <div class="footer">
        <div class="footer-company">RMC CORPORATE</div>
        <div>Bellavista 05, Edificio Olimpo, Of. 307, Viña del Mar | Teléfono: (32) 260 0305</div>
        <div>
            Sitio Web: <span class="footer-link">www.rmccorporate.com</span> | 
            Linkedin & YouTube: <span class="footer-link">RMC Corporate</span> | 
            Correo: <span class="footer-link">contacto@rmc.cl</span>
        </div>
    </div>

</body>
</html>